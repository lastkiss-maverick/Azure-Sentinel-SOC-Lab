# SOP: Handling Ubuntu Brute-Force Incidents

## 1. Objective
To provide a standardized process for investigating and responding to brute-force alerts generated by the "Ubuntu Brute Force Attempt" analytics rule in Microsoft Sentinel. This ensures all incidents are handled with a consistent methodology to minimize the risk of unauthorized access.

## 2. Trigger
An incident is automatically created when an external IP address exceeds **5 failed login attempts within a 5-minute window** on the `CORP-NET` Ubuntu VM.
<img width="763" height="471" alt="Screenshot 2025-12-19 at 10 33 35â€¯AM" src="https://github.com/user-attachments/assets/5c88ab6f-96f9-40be-9638-cc4594fc2ac9" />



---

## 3. Step-by-Step Investigation Workflow

### Phase 1: Initial Triage
1. **Assign the Incident:** Open the incident in the Sentinel **Incidents** blade. 
2. **Set Ownership:** Change the status from `New` to `Active` and assign the owner to yourself.
3. **Assess Severity:** Review the number of alerts associated with the incident. A massive spike in attempts from multiple IPs may indicate a coordinated distributed brute-force attack.

### Phase 2: Deep Analysis (The "Hunt")
1. **Check for Success:** The most critical step is to verify if the attacker successfully gained access. Run the following KQL query to check for "Accepted" passwords from the malicious IP:
   ```kusto
   Syslog
   | where Computer == "CORP-NET"
   | where Facility == "auth" or Facility == "authpriv"
   | where SyslogMessage has "Accepted password" or SyslogMessage has "session opened"
   | where SyslogMessage has "[Insert_Attacker_IP_Here]"
